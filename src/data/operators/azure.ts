import type { Operator } from '@/types'

export const AZURE_OPERATORS: Operator[] = [
  {
    id: 'kql-where',
    name: 'Filtrer rader',
    syntax: '| where felt == "verdi"',
    description: 'Filtrerer dataene på denne betingelsen',
    inputExample: 'Level == "Error"',
    category: 'filter',
    platforms: ['azure'],
    level: 'beginner',
  },
  {
    id: 'kql-contains',
    name: 'Inneholder tekst',
    syntax: '| where felt contains "tekst"',
    description: 'Finner rader som inneholder denne teksten (ikke skiller mellom store/små)',
    inputExample: 'Message contains "timeout"',
    category: 'basic',
    platforms: ['azure'],
    level: 'beginner',
  },
  {
    id: 'kql-has',
    name: 'Inneholder ord',
    syntax: '| where felt has "ord"',
    description: 'Raskere enn contains - finner hele ord (ikke delstrenger)',
    inputExample: 'Message has "error"',
    category: 'basic',
    platforms: ['azure'],
    level: 'advanced',
  },
  {
    id: 'kql-project',
    name: 'Velg kolonner',
    syntax: '| project felt1, felt2',
    description: 'Viser kun de valgte kolonnene i resultatet',
    inputExample: 'TimeGenerated, Level, Message',
    category: 'filter',
    platforms: ['azure'],
    level: 'beginner',
  },
  {
    id: 'kql-summarize',
    name: 'Oppsummer',
    syntax: '| summarize count() by felt',
    description: 'Grupperer og teller resultatene',
    inputExample: 'count() by Level',
    category: 'advanced',
    platforms: ['azure'],
    level: 'advanced',
  },
  {
    id: 'kql-timerange',
    name: 'Tidsvindu',
    syntax: '| where TimeGenerated > ago(1h)',
    description: 'Filtrerer på tid. h=timer, d=dager, m=minutter',
    inputExample: 'TimeGenerated > ago(24h)',
    category: 'date',
    platforms: ['azure'],
    level: 'beginner',
  },
  {
    id: 'kql-between',
    name: 'Mellom datoer',
    syntax: '| where felt between (start .. slutt)',
    description: 'Filtrerer på et datointervall',
    inputExample: 'TimeGenerated between (ago(7d) .. ago(1d))',
    category: 'date',
    platforms: ['azure'],
    level: 'advanced',
  },
  {
    id: 'kql-top',
    name: 'Begrens antall',
    syntax: '| top n by felt',
    description: 'Viser de n første radene sortert etter felt',
    inputExample: '100 by TimeGenerated desc',
    category: 'filter',
    platforms: ['azure'],
    level: 'beginner',
  },
  {
    id: 'kql-sort',
    name: 'Sorter',
    syntax: '| sort by felt desc',
    description: 'Sorterer resultatene. desc = synkende, asc = stigende',
    inputExample: 'TimeGenerated desc',
    category: 'filter',
    platforms: ['azure'],
    level: 'beginner',
  },
  {
    id: 'kql-extend',
    name: 'Beregnet kolonne',
    syntax: '| extend nyKolonne = uttrykk',
    description: 'Oppretter en ny kolonne med beregnet verdi',
    inputExample: 'DurationMs = Duration * 1000',
    category: 'advanced',
    platforms: ['azure'],
    level: 'advanced',
  },
  {
    id: 'kql-join',
    name: 'Koble tabeller',
    syntax: '| join kind=inner (Tabell2) on felt',
    description: 'Kobler to tabeller sammen på et felles felt',
    inputExample: 'kind=inner (Heartbeat) on Computer',
    category: 'advanced',
    platforms: ['azure'],
    level: 'expert',
  },
  {
    id: 'kql-render',
    name: 'Visualiser',
    syntax: '| render charttype',
    description: 'Viser resultatet som graf (timechart, barchart, piechart)',
    inputExample: 'timechart',
    category: 'advanced',
    platforms: ['azure'],
    level: 'advanced',
  },
]
